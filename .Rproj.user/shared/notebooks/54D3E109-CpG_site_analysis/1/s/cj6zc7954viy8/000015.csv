"0","## although pollutants must be converted to use ppm rather than ug/m^3"
"0",""
"0","merged_cpg_gene_region <- rbind(cpg_gene_regions_exp, cpg_gene_regions_no2,"
"0","                            cpg_gene_regions_o3, cpg_gene_regions_so2)"
"0","merged_cpg_gene_region$pollutant <- factor(merged_cpg_gene_region$pollutant,"
"0","                                        levels = c(""PM[2.5]"", ""NO[2]"","
"0","                                                   ""O[3]"", ""SO[2]""))"
"0",""
"0","four_forest_plots <- ggplot(data=merged_cpg_gene_region,"
"0","                              aes(x=label, y= mean, ymin = lower,ymax = upper))+"
"0","  geom_pointrange(aes(color=as.factor(label))) +"
"0","  scale_color_manual(values = rep(c(""#6A0DAD"","
"0","                                    ""#28A745"","
"0","                                    ""#1E90FF"","
"0","                                    ""#FF69B4"","
"0","                                    ""red""))) +"
"0","  geom_hline(yintercept=0, lty =2) +"
"0","  coord_flip() +"
"0","  ggtitle(""24 h Pollutant Exposure"") +"
"0","  ylab(expression(Delta * beta ~ ""per"" ~ mu * ""g/m""^3)) +"
"0","  xlab(""Genomic Region"") +"
"0","  facet_wrap(~pollutant, labeller = label_parsed,"
"0","             ncol = 1, scales = ""free_y"")  +"
"0","  ## zoom in on NO2, O3 data points which are on a smaller scale than SO2"
"0","  geom_magnify(data = subset("
"0","    merged_df_relation,"
"0","    merged_df_relation$pollutant!=""SO[2]"" & merged_df_relation$pollutant!=""PM[2.5]""),"
"0","    from = c(0.9, 5.1, -6.5e-5, 6.0e-5), "
"0","    to = c(0.7, 5.3, 0.002 ,0.014), axes=""x"""
"0","    , shadow = TRUE) +"
"0","  "
"0","  ## Zoom in on PM2.5 which is on a smaller scale than the other pollutants"
"0","  geom_magnify(data = subset("
"0","    merged_df_relation, merged_df_relation$pollutant == ""PM[2.5]"" ),"
"0","    from = c(0.9, 5.1, -2.5e-7, 2.5e-7), "
"0","    to = c(0.7, 5.3, 0.002 ,0.014), axes=""x"""
"0","    , shadow = TRUE) +"
"0","  theme("
"0","    title = element_text(size = 10),"
"0","    legend.position = ""none"""
"0","  ) +"
"0","  scale_y_continuous(limits = c(-0.00045,0.016))"
"0",""
"0","  #  "
"0","  # "
"0","merged_forest_cpg_region_plots <- ggarrange(four_forest_plots, forest_plot_mp,"
"0","            labels = c(""A"", ""B""),"
"0","            ncol = 1, nrow = 2, heights = c(4, 1))"
"2","Warning: [38;5;254mRemoved 1 row containing missing values or values outside the scale range (`geom_segment()`).[39m"
"0","  "
"0",""
"0","## For Thesis"
"0","ggsave("
"0","  ""thesis_cpg_gene_regions_forest"","
"0","  plot = merged_forest_plots,"
"0","  device = ""jpeg"","
"0","  path = NULL,"
"0","  scale = 1,"
"0","  width = 7.5,"
"0","  height = 8.5,"
"0","  units = c(""in""),"
"0","  dpi = 300,"
"0","  limitsize = TRUE,"
"0","  bg = NULL,"
"0","  create.dir = FALSE,"
"0",")"
"0",""
