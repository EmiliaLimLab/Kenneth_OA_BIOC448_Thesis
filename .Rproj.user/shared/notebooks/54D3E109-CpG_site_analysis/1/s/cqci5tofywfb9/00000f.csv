"0","## Multi-pollutant"
"0",""
"0","## Manhattan plot of the association between Multi-pollutant exposure"
"0","## and methylation"
"0",""
"0","don_mp <- df_mp[-log10(df_mp$p.value) > 1,] %>%"
"0","  group_by(chr) %>%"
"0","  summarise(chr_len=max(pos)) %>%"
"0","  mutate(tot=cumsum(as.numeric(chr_len))-as.numeric(chr_len)) %>%"
"0","  dplyr::select(-chr_len) %>%"
"0","  left_join(df_mp[-log10(df_mp$p.value) > 1,], ., by=c(""chr""=""chr"")) %>%"
"0","  arrange(chr,pos) %>%"
"0","  mutate(poscum=(pos+tot))"
"0",""
"0","axisdf = don_mp %>%"
"0","  group_by(chr) %>%"
"0","  summarize(center=(max(poscum)+ min(poscum))/2)"
"0",""
"0","mp_manplot <- ggplot(don_mp, aes(x=poscum, y=-log10(p.value))) +"
"0","  "
"0","  ## Show all points palette: fishualize::Mycteroperca_bonaci"
"0","  geom_point( aes(color=as.factor(chr)), alpha=0.8, size=1.3) +"
"0","  scale_color_manual(values = rep(c(""darkgray"", ""black""), 22 )) +"
"0","  "
"0","  ## Title and axis:"
"0","  ggtitle(""3 Year Ambient Multi-pollutant Exposure"") +"
"0","  xlab(""Chromosome"") +"
"0","  ylab(""-log10(observed p-value)"") +"
"0","  "
"0","  "
"0","  ## custom X axis:"
"0","  scale_x_continuous( label = axisdf$chr, breaks= axisdf$center ) +"
"0","  scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis"
"0","  "
"0","  ## highlight points that pass the threshold, colour based on methylated effect"
"0","  ## blue for hypermethylated, red for hypomethylated"
"0","  geom_point(data=subset(don_mp, adj_pvalue <= 0.5 & estimate < 0),"
"0","             colour=""red"","
"0","             size = 2.1) +"
"0","  geom_point(data=subset(don_mp, adj_pvalue <= 0.5 & estimate > 0),"
"0","             colour=""blue"","
"0","             size = 2.1) +"
"0","  "
"0","  ## label the points that pass the threshold value"
"0","  geom_label_repel(data=subset(don_mp, adj_pvalue <= 0.5),"
"0","                   aes(label=probe_id), size=2.8) +"
"0","  "
"0","  coord_cartesian(ylim = c(0,7)) +"
"0","  # Custom the theme:"
"0","  theme_bw() +"
"0","  theme("
"0","    legend.position=""none"","
"0","    panel.border = element_blank(),"
"0","    panel.grid.major.x = element_blank(),"
"0","    panel.grid.minor.x = element_blank()"
"0","  )"
"0",""
"0","# write.csv(don_mp, file = ""don_mp.csv"")"
"0",""
"0","##-----------------------------------------------------------------------------"
"0",""
"0","## PM2.5"
"0",""
"0","## A more Customizable Manhattan plot"
"0","don_exp <- df_exp[-log10(df_exp$p.value) > 1,] %>%"
"0","  group_by(chr) %>%"
"0","  summarise(chr_len=max(pos)) %>%"
"0","  mutate(tot=cumsum(as.numeric(chr_len))-as.numeric(chr_len)) %>%"
"0","  dplyr::select(-chr_len) %>%"
"0","  left_join(df_exp[-log10(df_exp$p.value) > 1,], ., by=c(""chr""=""chr"")) %>%"
"0","  arrange(chr,pos) %>%"
"0","  mutate(poscum=(pos+tot))"
"0",""
"0","axisdf = don_exp %>%"
"0","  group_by(chr) %>%"
"0","  summarize(center=(max(poscum)+ min(poscum))/2)"
"0",""
"0","exp_manplot <- ggplot(don_exp, aes(x=poscum, y=-log10(p.value))) +"
"0","  "
"0","  # Show all points palette: fishualize::Mycteroperca_bonaci"
"0","  geom_point(data = subset(don_exp, adj_pvalue > 0.5),"
"0","             aes(color=as.factor(chr)), alpha=0.8, size=1.3) +"
"0","  scale_color_manual(values = rep(c(""darkgray"", ""black""), 22 ),"
"0","                     guide = ""none"") +"
"0","  "
"0","  #Title and axis: main=expression(""PM""[2.5]*"" Exposure""))"
"0","  ggtitle(expression(""Association to 24 h PM""[2.5]*"" Exposure"")) +"
"0","  xlab(""Chromosome"") +"
"0","  ylab(""-log10(observed p-value)"") +"
"0","  "
"0","  "
"0","  # custom X axis:"
"0","  scale_x_continuous( label = axisdf$chr, breaks= axisdf$center ) +"
"0","  scale_y_continuous(expand = c(0, 0) ) +  "
"0","  # remove space between plot area and x axis"
"0","  "
"0","  # highlight points that pass the threshold, colour based on methylated effect"
"0","  # blue for hypermethylated, red for hypomethylated"
"0","  #geom_point(data=subset(don_exp, adj_pvalue <= 0.5 & estimate < 0),"
"0","  #           aes(color = ""Decrease""), size = 1.5) +"
"0","  #geom_point(data=subset(don_exp, adj_pvalue <= 0.5 & estimate > 0),"
"0","  #           aes(color = ""Increase""), size = 1.5) +"
"0","  geom_point(data=subset(don_exp, adj_pvalue <= 0.5 & estimate < 0),"
"0","             colour=""red"","
"0","             size = 2.1) +"
"0","  geom_point(data=subset(don_exp, adj_pvalue <= 0.5 & estimate > 0),"
"0","             colour=""blue"","
"0","             size = 2.1) +"
"0","  # scale_color_manual("
"0","  # values = c(""Increase"" = ""blue"","
"0","  #            ""Decrease"" = ""red""),"
"0","  # name = """","
"0","  # labels = c(""Increased Methylation"", ""Decreased Methylation"")) + "
"0","  #label the points that pass the threshold value"
"0","  geom_label_repel(data=don_exp[order(don_exp$adj_pvalue),][c(1:10)],"
"0","                   aes(label=probe_id),"
"0","                   min.segment.length = unit(0, 'lines'),"
"0","                   size=2.8) +"
"0","  "
"0","  coord_cartesian(ylim = c(0,7)) +"
"0","  # Custom the theme:"
"0","  theme_bw() +"
"0","  theme("
"0","    legend.position= c(0.9, 1.08),"
"0","    legend.justification = c(1,1),"
"0","    panel.border = element_blank(),"
"0","    panel.grid.major.x = element_blank(),"
"0","    panel.grid.minor.x = element_blank()"
"0","  )"
"0",""
"0","#guides(color = guide_legend(override.aes = list(size = 3)))"
"0",""
"0","# write.csv(don_exp, file = ""don_exp.csv"")"
"0",""
"0","##----------------------------------------------------------------------------"
"0",""
"0","## NO2"
"0",""
"0","## A more Customizable Manhattan plot"
"0","don_no2 <- df_no2[-log10(df_no2$p.value) > 1,] %>%"
"0","  group_by(chr) %>%"
"0","  summarise(chr_len=max(pos)) %>%"
"0","  mutate(tot=cumsum(as.numeric(chr_len))-as.numeric(chr_len)) %>%"
"0","  dplyr::select(-chr_len) %>%"
"0","  left_join(df_no2[-log10(df_no2$p.value) > 1,], ., by=c(""chr""=""chr"")) %>%"
"0","  arrange(chr,pos) %>%"
"0","  mutate(poscum=(pos+tot))"
"0",""
"0","axisdf = don_no2 %>%"
"0","  group_by(chr) %>%"
"0","  summarize(center=(max(poscum)+ min(poscum))/2)"
"0",""
"0","no2_manplot <- ggplot(don_no2, aes(x=poscum, y=-log10(p.value))) +"
"0","  "
"0","  # Show all points palette: fishualize::Mycteroperca_bonaci"
"0","  geom_point( aes(color=as.factor(chr)), alpha=0.8, size=1.3) +"
"0","  scale_color_manual(values = rep(c(""darkgray"", ""black""), 22 )) +"
"0","  "
"0","  #  geom_hline(yintercept=-log10(1.276817e-06), linetype=""dashed"", color = ""red"") +"
"0","  "
"0","  #Title and axis:"
"0","  ggtitle(expression(""24 h NO""[2]*"""")) +"
"0","  xlab(""Chromosome"") +"
"0","  ylab(""-log10(observed p-value)"") +"
"0","  "
"0","  "
"0","  # custom X axis:"
"0","  scale_x_continuous( label = axisdf$chr, breaks= axisdf$center ) +"
"0","  scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis"
"0","  "
"0","  # highlight points that pass the threshold, colour based on methylated effect"
"0","  # blue for hypermethylated, red for hypomethylated"
"0","  geom_point(data=subset(don_no2, adj_pvalue <= 0.5 & estimate < 0),"
"0","             colour=""red"","
"0","             size = 2.1) +"
"0","  geom_point(data=subset(don_no2, adj_pvalue <= 0.5 & estimate > 0),"
"0","             colour=""blue"","
"0","             size = 2.1) +"
"0","  "
"0","  #label the points that pass the threshold value"
"0","  geom_label_repel(data=don_no2[order(don_no2$adj_pvalue),][c(1:10)],"
"0","                   aes(label=probe_id),"
"0","                   min.segment.length = unit(0, 'lines'),"
"0","                   size=2.8) +"
"0",""
"0","coord_cartesian(ylim = c(0,7)) +"
"0","  # Custom the theme:"
"0","  theme_bw() +"
"0","  theme("
"0","    legend.position=""none"","
"0","    panel.border = element_blank(),"
"0","    panel.grid.major.x = element_blank(),"
"0","    panel.grid.minor.x = element_blank()"
"0","  )"
"0",""
"0","# write.csv(don_no2, file = ""don_no2.csv"")"
"0","    "
"0","##----------------------------------------------------------------------------"
"0","    "
"0","## O3"
"0","    "
"0","## A more Customizable Manhattan plot"
"0","don_o3 <- df_o3[-log10(df_o3$p.value) > 1,] %>%"
"0","  group_by(chr) %>%"
"0","  summarise(chr_len=max(pos)) %>%"
"0","  mutate(tot=cumsum(as.numeric(chr_len))-as.numeric(chr_len)) %>%"
"0","  dplyr::select(-chr_len) %>%"
"0","  left_join(df_o3[-log10(df_o3$p.value) > 1,], ., by=c(""chr""=""chr"")) %>%"
"0","  arrange(chr,pos) %>%"
"0","  mutate(poscum=(pos+tot))"
"0",""
"0","axisdf = don_o3 %>%"
"0","  group_by(chr) %>%"
"0","  summarize(center=(max(poscum)+ min(poscum))/2)"
"0",""
"0","o3_manplot <- ggplot(don_o3, aes(x=poscum, y=-log10(p.value))) +"
"0","  "
"0","  # Show all points palette: fishualize::Mycteroperca_bonaci"
"0","  geom_point( aes(color=as.factor(chr)), alpha=0.8, size=1.3) +"
"0","  scale_color_manual(values = rep(c(""darkgray"", ""black""), 22 )) +"
"0","  "
"0","  #Title and axis:"
"0","  ggtitle(expression(""24 h O""[3]*"""")) +"
"0","  xlab(""Chromosome"") +"
"0","  ylab(""-log10(observed p-value)"") +"
"0","  "
"0","  "
"0","  # custom X axis:"
"0","  scale_x_continuous( label = axisdf$chr, breaks= axisdf$center ) +"
"0","  scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis"
"0","  "
"0","  # highlight points that pass the threshold, colour based on methylated effect"
"0","  # blue for hypermethylated, red for hypomethylated"
"0","  geom_point(data=subset(don_o3, adj_pvalue <= 0.5 & estimate < 0),"
"0","             colour=""red"","
"0","             size = 2.1) +"
"0","  geom_point(data=subset(don_o3, adj_pvalue <= 0.5 & estimate > 0),"
"0","             colour=""blue"","
"0","             size = 2.1) +"
"0","  "
"0","  #label the points that pass the threshold value"
"0","  geom_label_repel(data=subset(don_o3, adj_pvalue <= 0.5),"
"0","                   aes(label=probe_id), size=2.8) +"
"0","  "
"0","  "
"0","  coord_cartesian(ylim = c(0,7)) +"
"0","  # Custom the theme:"
"0","  theme_bw() +"
"0","  theme("
"0","    legend.position=""none"","
"0","    panel.border = element_blank(),"
"0","    panel.grid.major.x = element_blank(),"
"0","    panel.grid.minor.x = element_blank()"
"0","  )"
"0",""
"0","# write.csv(don_o3, file = ""don_o3.csv"")"
"0","## ----------------------------------------------------------------------------"
"0",""
"0","## SO2"
"0",""
"0","## A more Customizable Manhattan plot"
"0","don_so2 <- df_so2[-log10(df_so2$p.value) > 1,] %>%"
"0","  group_by(chr) %>%"
"0","  summarise(chr_len=max(pos)) %>%"
"0","  mutate(tot=cumsum(as.numeric(chr_len))-as.numeric(chr_len)) %>%"
"0","  dplyr::select(-chr_len) %>%"
"0","  left_join(df_so2[-log10(df_so2$p.value) > 1,], ., by=c(""chr""=""chr"")) %>%"
"0","  arrange(chr,pos) %>%"
"0","  mutate(poscum=(pos+tot))"
"0",""
"0","axisdf = don_so2 %>%"
"0","  group_by(chr) %>%"
"0","  summarize(center=(max(poscum)+ min(poscum))/2)"
"0",""
"0","so2_manplot <- ggplot(don_so2, aes(x=poscum, y=-log10(p.value))) +"
"0",""
"0","    # Show all points palette: fishualize::Mycteroperca_bonaci"
"0","    geom_point( aes(color=as.factor(chr)), alpha=0.8, size=1.3) +"
"0","    scale_color_manual(values = rep(c(""darkgray"", ""black""), 22 )) +"
"0","  "
"0","    #Title and axis:"
"0","    ggtitle(expression(""24 h SO""[2]*"""")) +"
"0","    xlab(""Chromosome"") +"
"0","    ylab(""-log10(observed p-value)"") +"
"0","    "
"0",""
"0","    # custom X axis:"
"0","    scale_x_continuous( label = axisdf$chr, breaks= axisdf$center ) +"
"0","    scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis"
"0","  "
"0","    # highlight points that pass the threshold, colour based on methylated effect"
"0","    # blue for hypermethylated, red for hypomethylated"
"0","    geom_point(data=subset(don_so2, adj_pvalue <= 0.5 & estimate < 0),"
"0","               colour=""red"","
"0","               size = 2.1) +"
"0","    geom_point(data=subset(don_so2, adj_pvalue <= 0.5 & estimate > 0),"
"0","               colour=""blue"","
"0","               size = 2.1) +"
"0","    "
"0","    #label the points that pass the threshold value"
"0","    geom_label_repel(data=subset(don_so2, adj_pvalue <= 0.5),"
"0","                    aes(label=probe_id), size=2.8) +"
"0","  "
"0","    coord_cartesian(ylim = c(0,7)) +"
"0","    # Custom the theme:"
"0","    theme_bw() +"
"0","    theme("
"0","      legend.position=""none"","
"0","      panel.border = element_blank(),"
"0","      panel.grid.major.x = element_blank(),"
"0","      panel.grid.minor.x = element_blank()"
"0","    )"
"0",""
"0","## write.csv(don_so2, file = ""don_so2.csv"")"
