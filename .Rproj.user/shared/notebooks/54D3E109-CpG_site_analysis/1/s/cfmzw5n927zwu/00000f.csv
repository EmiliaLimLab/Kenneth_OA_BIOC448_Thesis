"0","## Multi-pollutant"
"0",""
"0","## Multipollutant Methylation Patterns"
"0","## https://stackoverflow.com/questions/38062650/forest-plot-for-a-beginner-simple-example-using-ggplot2-edited"
"0",""
"0","## The genomic regions we are observing here are TSS1500,Body, 3'UTR, 5'UTR,"
"0","## TSS200, "
"0","TSS200_df <- df_mp[grepl(""TSS200"",df_mp$UCSC_RefGene_Group),]"
"0","TSS200_ttest <- t.test(TSS200_df$estimate, mu = 0)"
"0","TSS200_mean <- mean(TSS200_df$estimate)"
"0","TSS200_lower <- TSS200_ttest$conf.int[1]"
"0","TSS200_upper <- TSS200_ttest$conf.int[2]"
"0",""
"0","TSS1500_df <- df_mp[grepl(""TSS1500"",df_mp$UCSC_RefGene_Group),]"
"0","TSS1500_ttest <- t.test(TSS1500_df$estimate, mu = 0)"
"0","TSS1500_mean <- mean(TSS1500_df$estimate)"
"0","TSS1500_lower <- TSS1500_ttest$conf.int[1]"
"0","TSS1500_upper <- TSS1500_ttest$conf.int[2]"
"0",""
"0","exon1_df <- df_mp[grepl(""1stExon"",df_mp$UCSC_RefGene_Group),]"
"0","exon1_ttest <- t.test(exon1_df$estimate, mu = 0)"
"0","exon1_mean <- mean(exon1_df$estimate)"
"0","exon1_lower <- exon1_ttest$conf.int[1]"
"0","exon1_upper <- exon1_ttest$conf.int[2]"
"0",""
"0","body_df <- df_mp[grepl(""Body"",df_mp$UCSC_RefGene_Group),]"
"0","body_ttest <- t.test(body_df$estimate, mu = 0)"
"0","body_mean <- mean(body_df$estimate)"
"0","body_lower <- body_ttest$conf.int[1]"
"0","body_upper <- body_ttest$conf.int[2]"
"0",""
"0","UTR3_df <- df_mp[grepl(""3'UTR"",df_mp$UCSC_RefGene_Group),]"
"0","UTR3_ttest <- t.test(UTR3_df$estimate, mu = 0)"
"0","UTR3_mean <- mean(UTR3_df$estimate)"
"0","UTR3_lower <- UTR3_ttest$conf.int[1]"
"0","UTR3_upper <- UTR3_ttest$conf.int[2]"
"0",""
"0","UTR5_df <- df_mp[grepl(""5'UTR"",df_mp$UCSC_RefGene_Group),]"
"0","UTR5_ttest <- t.test(UTR5_df$estimate, mu = 0)"
"0","UTR5_mean <- mean(UTR5_df$estimate)"
"0","UTR5_lower <- UTR5_ttest$conf.int[1]"
"0","UTR5_upper <- UTR5_ttest$conf.int[2]"
"0",""
"0",""
"0",""
"0","df__region_relation_mp <- data.frame(label = c(""TSS200"",""TSS1500"",""Body"", ""1stExon"","
"0","                                    ""3'UTR"",""5'UTR""),"
"0","                          mean = c(TSS200_mean,TSS1500_mean,body_mean,"
"0","                                   exon1_mean,UTR3_mean,UTR5_mean),"
"0","                          lower = c(TSS200_lower,TSS1500_lower,body_lower,"
"0","                                    exon1_lower,UTR3_lower,UTR5_lower),"
"0","                          upper = c(TSS200_upper,TSS1500_upper,body_upper,"
"0","                                    exon1_upper,UTR3_upper,UTR5_upper),"
"0","                          pollutant = ""Multi-pollutant"")"
"0","## reverses the factor level ordering for labels"
"0","df__region_relation_mp$label <- factor(df__region_relation_mp$label,"
"0","                            levels=rev(df__region_relation_mp$label))"
"0","forest_plot_genes_mp <- ggplot(data=df__region_relation_mp, aes(x=label, y= mean,"
"0","                                            ymin = lower,"
"0","                                            ymax = upper)) +"
"0","  geom_pointrange(aes(color=as.factor(label))) +"
"0","  scale_color_manual(values = rep(c(""#6A0DAD"","
"0","                                    ""#28A745"","
"0","                                    ""#1E90FF"","
"0","                                    ""#FF69B4"","
"0","                                    ""red"","
"0","                                    ""orange""))) +"
"0","  geom_hline(yintercept=0, lty =2) +"
"0","  coord_flip() +"
"0","  ggtitle(""3 Year Ambient Multi-pollutant Exposure"") +"
"0","  ylab(expression(paste(Delta,beta, "" per indicator unit""))) +"
"0","  xlab(""Region"") +"
"0","  scale_y_continuous(limits = c(-0.00016,0.00016)) +"
"0","  theme(legend.position = ""none"")"
"0",""
"0","## --------------------------------------------------------------------------"
"0",""
"0","  ## PM2.5 24 h exposure"
"0","## The genomic regions we are observing here are TSS1500,Body, 3'UTR, 5'UTR,"
"0","## TSS200, "
"0","TSS200_df <- df_exp[grepl(""TSS200"",df_exp$UCSC_RefGene_Group),]"
"0","TSS200_ttest <- t.test(TSS200_df$estimate, mu = 0)"
"0","TSS200_mean <- mean(TSS200_df$estimate)"
"0","TSS200_lower <- TSS200_ttest$conf.int[1]"
"0","TSS200_upper <- TSS200_ttest$conf.int[2]"
"0",""
"0","TSS1500_df <- df_exp[grepl(""TSS1500"",df_exp$UCSC_RefGene_Group),]"
"0","TSS1500_ttest <- t.test(TSS1500_df$estimate, mu = 0)"
"0","TSS1500_mean <- mean(TSS1500_df$estimate)"
"0","TSS1500_lower <- TSS1500_ttest$conf.int[1]"
"0","TSS1500_upper <- TSS1500_ttest$conf.int[2]"
"0",""
"0","exon1_df <- df_exp[grepl(""1stExon"",df_exp$UCSC_RefGene_Group),]"
"0","exon1_ttest <- t.test(exon1_df$estimate, mu = 0)"
"0","exon1_mean <- mean(exon1_df$estimate)"
"0","exon1_lower <- exon1_ttest$conf.int[1]"
"0","exon1_upper <- exon1_ttest$conf.int[2]"
"0",""
"0","body_df <- df_exp[grepl(""Body"",df_exp$UCSC_RefGene_Group),]"
"0","body_ttest <- t.test(body_df$estimate, mu = 0)"
"0","body_mean <- mean(body_df$estimate)"
"0","body_lower <- body_ttest$conf.int[1]"
"0","body_upper <- body_ttest$conf.int[2]"
"0",""
"0","UTR3_df <- df_exp[grepl(""3'UTR"",df_exp$UCSC_RefGene_Group),]"
"0","UTR3_ttest <- t.test(UTR3_df$estimate, mu = 0)"
"0","UTR3_mean <- mean(UTR3_df$estimate)"
"0","UTR3_lower <- UTR3_ttest$conf.int[1]"
"0","UTR3_upper <- UTR3_ttest$conf.int[2]"
"0",""
"0","UTR5_df <- df_exp[grepl(""5'UTR"",df_exp$UCSC_RefGene_Group),]"
"0","UTR5_ttest <- t.test(UTR5_df$estimate, mu = 0)"
"0","UTR5_mean <- mean(UTR5_df$estimate)"
"0","UTR5_lower <- UTR5_ttest$conf.int[1]"
"0","UTR5_upper <- UTR5_ttest$conf.int[2]"
"0",""
"0",""
"0",""
"0","df_region_relation_exp <- data.frame(label = c(""TSS200"",""TSS1500"",""Body"", ""1stExon"","
"0","                                    ""3'UTR"",""5'UTR""),"
"0","                          mean = c(TSS200_mean,TSS1500_mean,body_mean,"
"0","                                   exon1_mean,UTR3_mean,UTR5_mean),"
"0","                          lower = c(TSS200_lower,TSS1500_lower,body_lower,"
"0","                                    exon1_lower,UTR3_lower,UTR5_lower),"
"0","                          upper = c(TSS200_upper,TSS1500_upper,body_upper,"
"0","                                    exon1_upper,UTR3_upper,UTR5_upper),"
"0","                          pollutant = ""PM[2.5]"")"
"0","## reverses the factor level ordering for labels"
"0","df_region_relation_exp$label <- factor(df_region_relation_exp$label,"
"0","                            levels=rev(df_region_relation_exp$label))"
"0","forest_plot_genes_pm <- ggplot(data=df_region_relation_exp, aes(x=label, y= mean,"
"0","                                            ymin = lower,"
"0","                                            ymax = upper)) +"
"0","  geom_pointrange(aes(color=as.factor(label))) +"
"0","  scale_color_manual(values = rep(c(""#6A0DAD"","
"0","                                    ""#28A745"","
"0","                                    ""#1E90FF"","
"0","                                    ""#FF69B4"","
"0","                                    ""red"","
"0","                                    ""orange""))) +"
"0","  geom_hline(yintercept=0, lty =2) +"
"0","  coord_flip() +"
"0","  ggtitle(expression(""24 h PM""[2.5]* "" Exposure"")) +"
"0","  ylab(expression(paste(Delta,beta, "" per "", mu, ""g/m""^3))) +"
"0","  xlab(""Region"") +"
"0","  scale_y_continuous(limits = c(-1.2e-7,1.2e-7)) +"
"0","  theme("
"0","    legend.position = ""none"")"
"0",""
"0","##---------------------------------------------------------------------------"
"0",""
"0","  ## NO2 24 h exposure"
"0",""
"0","## The genomic regions we are observing here are TSS1500,Body, 3'UTR, 5'UTR,"
"0","## TSS200, "
"0","TSS200_df <- df_no2[grepl(""TSS200"",df_no2$UCSC_RefGene_Group),]"
"0","TSS200_ttest <- t.test(TSS200_df$estimate, mu = 0)"
"0","TSS200_mean <- mean(TSS200_df$estimate)"
"0","TSS200_lower <- TSS200_ttest$conf.int[1]"
"0","TSS200_upper <- TSS200_ttest$conf.int[2]"
"0",""
"0","TSS1500_df <- df_no2[grepl(""TSS1500"",df_no2$UCSC_RefGene_Group),]"
"0","TSS1500_ttest <- t.test(TSS1500_df$estimate, mu = 0)"
"0","TSS1500_mean <- mean(TSS1500_df$estimate)"
"0","TSS1500_lower <- TSS1500_ttest$conf.int[1]"
"0","TSS1500_upper <- TSS1500_ttest$conf.int[2]"
"0",""
"0","exon1_df <- df_no2[grepl(""1stExon"",df_no2$UCSC_RefGene_Group),]"
"0","exon1_ttest <- t.test(exon1_df$estimate, mu = 0)"
"0","exon1_mean <- mean(exon1_df$estimate)"
"0","exon1_lower <- exon1_ttest$conf.int[1]"
"0","exon1_upper <- exon1_ttest$conf.int[2]"
"0",""
"0","body_df <- df_no2[grepl(""Body"",df_no2$UCSC_RefGene_Group),]"
"0","body_ttest <- t.test(body_df$estimate, mu = 0)"
"0","body_mean <- mean(body_df$estimate)"
"0","body_lower <- body_ttest$conf.int[1]"
"0","body_upper <- body_ttest$conf.int[2]"
"0",""
"0","UTR3_df <- df_no2[grepl(""3'UTR"",df_no2$UCSC_RefGene_Group),]"
"0","UTR3_ttest <- t.test(UTR3_df$estimate, mu = 0)"
"0","UTR3_mean <- mean(UTR3_df$estimate)"
"0","UTR3_lower <- UTR3_ttest$conf.int[1]"
"0","UTR3_upper <- UTR3_ttest$conf.int[2]"
"0",""
"0","UTR5_df <- df_no2[grepl(""5'UTR"",df_no2$UCSC_RefGene_Group),]"
"0","UTR5_ttest <- t.test(UTR5_df$estimate, mu = 0)"
"0","UTR5_mean <- mean(UTR5_df$estimate)"
"0","UTR5_lower <- UTR5_ttest$conf.int[1]"
"0","UTR5_upper <- UTR5_ttest$conf.int[2]"
"0",""
"0",""
"0",""
"0","df_region_relation_no2 <- data.frame(label = c(""TSS200"",""TSS1500"",""Body"", ""1stExon"","
"0","                                    ""3'UTR"",""5'UTR""),"
"0","                          mean = c(TSS200_mean,TSS1500_mean,body_mean,"
"0","                                   exon1_mean,UTR3_mean,UTR5_mean),"
"0","                          lower = c(TSS200_lower,TSS1500_lower,body_lower,"
"0","                                    exon1_lower,UTR3_lower,UTR5_lower),"
"0","                          upper = c(TSS200_upper,TSS1500_upper,body_upper,"
"0","                                    exon1_upper,UTR3_upper,UTR5_upper),"
"0","                          pollutant = ""NO[2]"")"
"0","## reverses the factor level ordering for labels"
"0","df_region_relation_no2$label <- factor(df_region_relation_no2$label,"
"0","                            levels=rev(df_region_relation_no2$label))"
"0","forest_plot_genes_no2 <- ggplot(data=df_region_relation_no2, aes(x=label, y= mean,"
"0","                                            ymin = lower,"
"0","                                            ymax = upper)) +"
"0","  geom_pointrange(aes(color=as.factor(label))) +"
"0","  scale_color_manual(values = rep(c(""#6A0DAD"","
"0","                                    ""#28A745"","
"0","                                    ""#1E90FF"","
"0","                                    ""#FF69B4"","
"0","                                    ""red"","
"0","                                    ""orange""))) +"
"0","  geom_hline(yintercept=0, lty =2) +"
"0","  coord_flip() +"
"0","  ggtitle(expression(""24 h NO""[2]* "" Exposure"")) +"
"0","  ylab(expression(paste(Delta,beta, "" per "", mu, ""g/m""^3))) +"
"0","  xlab(""Region"") +"
"0","  scale_y_continuous(limits = c(-7.5e-5,7.5e-5)) +"
"0","  theme("
"0","    legend.position = ""none"")"
"0",""
"0","##----------------------------------------------------------------------------"
"0",""
"0","  ## O3 24 h Exposure"
"0",""
"0","## The genomic regions we are observing here are TSS1500,Body, 3'UTR, 5'UTR,"
"0","## TSS200, "
"0","TSS200_df <- df_o3[grepl(""TSS200"",df_o3$UCSC_RefGene_Group),]"
"0","TSS200_ttest <- t.test(TSS200_df$estimate, mu = 0)"
"0","TSS200_mean <- mean(TSS200_df$estimate)"
"0","TSS200_lower <- TSS200_ttest$conf.int[1]"
"0","TSS200_upper <- TSS200_ttest$conf.int[2]"
"0",""
"0","TSS1500_df <- df_o3[grepl(""TSS1500"",df_o3$UCSC_RefGene_Group),]"
"0","TSS1500_ttest <- t.test(TSS1500_df$estimate, mu = 0)"
"0","TSS1500_mean <- mean(TSS1500_df$estimate)"
"0","TSS1500_lower <- TSS1500_ttest$conf.int[1]"
"0","TSS1500_upper <- TSS1500_ttest$conf.int[2]"
"0",""
"0","exon1_df <- df_o3[grepl(""1stExon"",df_o3$UCSC_RefGene_Group),]"
"0","exon1_ttest <- t.test(exon1_df$estimate, mu = 0)"
"0","exon1_mean <- mean(exon1_df$estimate)"
"0","exon1_lower <- exon1_ttest$conf.int[1]"
"0","exon1_upper <- exon1_ttest$conf.int[2]"
"0",""
"0","body_df <- df_o3[grepl(""Body"",df_o3$UCSC_RefGene_Group),]"
"0","body_ttest <- t.test(body_df$estimate, mu = 0)"
"0","body_mean <- mean(body_df$estimate)"
"0","body_lower <- body_ttest$conf.int[1]"
"0","body_upper <- body_ttest$conf.int[2]"
"0",""
"0","UTR3_df <- df_o3[grepl(""3'UTR"",df_o3$UCSC_RefGene_Group),]"
"0","UTR3_ttest <- t.test(UTR3_df$estimate, mu = 0)"
"0","UTR3_mean <- mean(UTR3_df$estimate)"
"0","UTR3_lower <- UTR3_ttest$conf.int[1]"
"0","UTR3_upper <- UTR3_ttest$conf.int[2]"
"0",""
"0","UTR5_df <- df_o3[grepl(""5'UTR"",df_o3$UCSC_RefGene_Group),]"
"0","UTR5_ttest <- t.test(UTR5_df$estimate, mu = 0)"
"0","UTR5_mean <- mean(UTR5_df$estimate)"
"0","UTR5_lower <- UTR5_ttest$conf.int[1]"
"0","UTR5_upper <- UTR5_ttest$conf.int[2]"
"0",""
"0",""
"0",""
"0","df_region_relation_o3 <- data.frame(label = c(""TSS200"",""TSS1500"",""Body"", ""1stExon"","
"0","                                    ""3'UTR"",""5'UTR""),"
"0","                          mean = c(TSS200_mean,TSS1500_mean,body_mean,"
"0","                                   exon1_mean,UTR3_mean,UTR5_mean),"
"0","                          lower = c(TSS200_lower,TSS1500_lower,body_lower,"
"0","                                    exon1_lower,UTR3_lower,UTR5_lower),"
"0","                          upper = c(TSS200_upper,TSS1500_upper,body_upper,"
"0","                                    exon1_upper,UTR3_upper,UTR5_upper),"
"0","                          pollutant = ""O[3]"")"
"0","## reverses the factor level ordering for labels"
"0","df_region_relation_o3$label <- factor(df_region_relation_o3$label,"
"0","                            levels=rev(df_region_relation_o3$label))"
"0","forest_plot_genes_o3 <- ggplot(data=df_region_relation_o3, aes(x=label, y= mean,"
"0","                                            ymin = lower,"
"0","                                            ymax = upper)) +"
"0","  geom_pointrange(aes(color=as.factor(label))) +"
"0","  scale_color_manual(values = rep(c(""#6A0DAD"","
"0","                                    ""#28A745"","
"0","                                    ""#1E90FF"","
"0","                                    ""#FF69B4"","
"0","                                    ""red"","
"0","                                    ""orange""))) +"
"0","  geom_hline(yintercept=0, lty =2) +"
"0","  coord_flip() +"
"0","  ggtitle(expression(""24 h O""[3]* "" Exposure"")) +"
"0","  ylab(expression(paste(Delta,beta, "" per "", mu, ""g/m""^3))) +"
"0","  xlab(""Region"") +"
"0","  scale_y_continuous(limits = c(-7.5e-5,7.5e-5)) +"
"0","  theme("
"0","    legend.position = ""none"")"
"0",""
"0","##---------------------------------------------------------------------------"
"0",""
"0","  ## SO2 24 h exposure"
"0","## The genomic regions we are observing here are TSS1500,Body, 3'UTR, 5'UTR,"
"0","## TSS200, "
"0",""
"0","TSS200_df <- df_so2[grepl(""TSS200"",df_so2$UCSC_RefGene_Group),]"
"0","TSS200_ttest <- t.test(TSS200_df$estimate, mu = 0)"
"0","TSS200_mean <- mean(TSS200_df$estimate)"
"0","TSS200_lower <- TSS200_ttest$conf.int[1]"
"0","TSS200_upper <- TSS200_ttest$conf.int[2]"
"0",""
"0","TSS1500_df <- df_so2[grepl(""TSS1500"",df_so2$UCSC_RefGene_Group),]"
"0","TSS1500_ttest <- t.test(TSS1500_df$estimate, mu = 0)"
"0","TSS1500_mean <- mean(TSS1500_df$estimate)"
"0","TSS1500_lower <- TSS1500_ttest$conf.int[1]"
"0","TSS1500_upper <- TSS1500_ttest$conf.int[2]"
"0",""
"0","exon1_df <- df_so2[grepl(""1stExon"",df_so2$UCSC_RefGene_Group),]"
"0","exon1_ttest <- t.test(exon1_df$estimate, mu = 0)"
"0","exon1_mean <- mean(exon1_df$estimate)"
"0","exon1_lower <- exon1_ttest$conf.int[1]"
"0","exon1_upper <- exon1_ttest$conf.int[2]"
"0",""
"0","body_df <- df_so2[grepl(""Body"",df_so2$UCSC_RefGene_Group),]"
"0","body_ttest <- t.test(body_df$estimate, mu = 0)"
"0","body_mean <- mean(body_df$estimate)"
"0","body_lower <- body_ttest$conf.int[1]"
"0","body_upper <- body_ttest$conf.int[2]"
"0",""
"0","UTR3_df <- df_so2[grepl(""3'UTR"",df_so2$UCSC_RefGene_Group),]"
"0","UTR3_ttest <- t.test(UTR3_df$estimate, mu = 0)"
"0","UTR3_mean <- mean(UTR3_df$estimate)"
"0","UTR3_lower <- UTR3_ttest$conf.int[1]"
"0","UTR3_upper <- UTR3_ttest$conf.int[2]"
"0",""
"0","UTR5_df <- df_so2[grepl(""5'UTR"",df_so2$UCSC_RefGene_Group),]"
"0","UTR5_ttest <- t.test(UTR5_df$estimate, mu = 0)"
"0","UTR5_mean <- mean(UTR5_df$estimate)"
"0","UTR5_lower <- UTR5_ttest$conf.int[1]"
"0","UTR5_upper <- UTR5_ttest$conf.int[2]"
"0",""
"0",""
"0",""
"0","df_region_relation_so2 <- data.frame(label = c(""TSS200"",""TSS1500"",""Body"", ""1stExon"","
"0","                                    ""3'UTR"",""5'UTR""),"
"0","                          mean = c(TSS200_mean,TSS1500_mean,body_mean,"
"0","                                   exon1_mean,UTR3_mean,UTR5_mean),"
"0","                          lower = c(TSS200_lower,TSS1500_lower,body_lower,"
"0","                                    exon1_lower,UTR3_lower,UTR5_lower),"
"0","                          upper = c(TSS200_upper,TSS1500_upper,body_upper,"
"0","                                    exon1_upper,UTR3_upper,UTR5_upper),"
"0","                          pollutant = ""SO[2]"")"
"0","## reverses the factor level ordering for labels"
"0","df_region_relation_so2$label <- factor(df_region_relation_so2$label,"
"0","                            levels=rev(df_region_relation_so2$label))"
"0","forest_plot_genes_so2 <- ggplot(data=df_region_relation_so2, aes(x=label, y= mean,"
"0","                                            ymin = lower,"
"0","                                            ymax = upper)) +"
"0","  geom_pointrange(aes(color=as.factor(label))) +"
"0","  scale_color_manual(values = rep(c(""#6A0DAD"","
"0","                                    ""#28A745"","
"0","                                    ""#1E90FF"","
"0","                                    ""#FF69B4"","
"0","                                    ""red"","
"0","                                    ""orange""))) +"
"0","  geom_hline(yintercept=0, lty =2) +"
"0","  coord_flip() +"
"0","  ggtitle(expression(""24 h SO""[2]* "" Exposure"")) +"
"0","  ylab(expression(paste(Delta,beta, "" per "", mu, ""g/m""^3))) +"
"0","  xlab(""Region"") +"
"0","  scale_y_continuous(limits = c(-0.01,0.01)) +"
"0","  theme(legend.position = ""none"")"
"0",""
